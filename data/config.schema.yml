basic:
  required:
    - "platforms"
    - "protocols"
  platforms:
    - regex: "^(?:ios|iosxr|junos|bird|frr|container)$"
  protocols:
    - regex: "^(?:bgp|ospf)$"
  addressFamily:
    regex: "^(?:ipv4|ipv6|ipv4_ipv6)$"
  routeSource:
    regex: "^(?:random|mrt|partial_random_mrt)$"
  routeExport:
    required:
      - "location"
      - "fileName"
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.json$"

mrt:
  required:
    - "collector"
  collector:
    regex: "^.*$"

prefixes:
  required:
    - "quantity"
    - "prefixLengthRanges"
  quantity:
    regex: "^[0-9]+?(?:-[0-9]+)?$"
  prefixLengthRanges:
    - required:
        - "value"
      value:
        regex: "^(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))(?:-(?:/(?:[1-9]|[1-2][0-9]|3[0-2])))?$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  routeSeed:
    regex: ".*"
  includePrivateSpace:
    - required:
        - "value"
      value:
        regex: "^(?:True|False)$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"

bgp:
  required:
    - "aspath"
  aspath:
    required:
      - "quantity"
    mode:
      - required:
          - "value"
        value:
          regex: "^(?:2byte|4byte)$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    quantity:
      - required:
          - "value"
        value:
          regex: "^[0-9]+?(?:-[0-9]+)?$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    includePrivateAS:
      - required:
          - "value"
        value:
          regex: "^(?:True|False$)"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  communities:
    required:
      - "quantity"
    mode:
      - required:
          - "value"
        value:
          regex: "^(?:standard|large|standard_large)$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    quantity:
      - required:
          - "value"
        value:
          regex: "^[0-9]+?(?:-[0-9]+)?$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    includeWellKnown:
      - required:
          - "value"
        value:
          regex: "^(?:True|False$)"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  nexthop:
    - required:
        - "value"
      value:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  origin:
    - required:
        - "value"
      value:
        regex: "^(?:igp|egp|incomplete)$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"

ospf:
  required:
    - "routeType"
  routeType:
    - required:
        - "value"
      value:
        regex: "^(?:intra_area|inter_area|external_type1|external_type2|nssa_type1|nssa_type2)$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  metricRanges:
    - required:
        - "value"
      value:
        regex: "^(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])(?:-(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]))?$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"

device:
  required:
    - None
  configExport:
    required:
      - None
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.txt$"
  ios:
    required:
      - None
    localAS:
      regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
    vrf:
      regex: ".*"
    deployment:
      required:
        - "address"
      address:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
  junos:
    required:
      - None
    vrf:
      regex: ".*"
    bgpGroup:
      regex: ".*"
    deployment:
      required:
        - "address"
      address:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
  bird:
    required:
      - None
  frr:
    required:
      - None

container:
  required:
    - None
  imageExport:
    required:
      - None
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.tar$"
  configExport:
    required:
      - None
    location:
      regex: ".*"
  bgp:
    required:
      - "localAS"
      - "rid"
    localAS:
      regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
    rid:
      regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
    neighbors:
      - required:
          - "address"
          - "asn"
        address:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
        asn:
          regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
  ospf:
    required:
      - "rid"
      - "areaID"
    rid:
      regex: "^(?:(?:0\\.0\\.0\\.(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))$"
    areaID:
      regex: "^(?:(?:0\\.0\\.0\\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])|(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]))$"
  networking:
    required:
      - "mode"
    mode:
      regex: "^(?:dynamic|static)$"
    static:
      required:
        - None
      ipv4:
        required:
          - address
        address:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
        gateway:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
      ipv6:
        required:
          - address
        address:
          regex: "^(?:(?:(?:[0-9a-fA-F]{1,4}:){1,7}:)|(?:(?:[0-9a-fA-F]{1,4}:){1,6}:(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,5}:(?:[0-9a-fA-F]{1,4}:)(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,4}:(?:[0-9a-fA-F]{1,4}:){2}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,3}:(?:[0-9a-fA-F]{1,4}:){3}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,2}:(?:[0-9a-fA-F]{1,4}:){4}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:):(?:[0-9a-fA-F]{1,4}:){5}(?:[0-9a-fA-F]{1,4}))|(?:::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}))(?:/(?:[1-9]|[1-9][0-9]|1[0-1][0-9]|12[0-8]))$"
        gateway:
          regex: "^(?:(?:::)|(?:(?:[0-9a-fA-F]{1,4}:){1,7}:)|(?:(?:[0-9a-fA-F]{1,4}:){1,6}:(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,5}:(?:[0-9a-fA-F]{1,4}:)(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,4}:(?:[0-9a-fA-F]{1,4}:){2}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,3}:(?:[0-9a-fA-F]{1,4}:){3}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,2}:(?:[0-9a-fA-F]{1,4}:){4}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:):(?:[0-9a-fA-F]{1,4}:){5}(?:[0-9a-fA-F]{1,4}))|(?:::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}))$"
  attributes:
    - required:
        - "name"
        - "value"
      name:
        regex: ".*"
      value:
        regex: ".*"

policy:
  required:
    - None
  constraints:
    required:
      - None
    prefix:
      required:
        - "action"
        - "values"
      action:
        regex: "^(?:include|exclude)$"
      values:
        - required:
            - "value"
          value:
            regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_aspath:
      required:
        - "action"
        - "values"
      action:
        regex: "^(?:include|exclude)$"
      values:
        required:
          - None
        origin:
          - required:
              - "value"
            value:
              regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
            probability:
              regex: "^(?:[1-9]|[1-9][0-9]|100)$"
        transit:
          - required:
              - "value"
            value:
              regex: "^(?:(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))(?: (?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))*)$"
            probability:
              regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_communities:
      required:
        - "action"
        - "values"
      action:
        regex: "^(?:include|exclude)$"
      values:
        - required:
            - "value"
          value:
            regex: "^(?:(?:(?:6553[6-9]|655[4-9][0-9]|65[6-9][0-9]{2}|6[6-9][0-9]{3}|7[0-9]{4}|[1-9][0-9]{5,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|4294900[0-9]{3}|4294901[0-6][0-9]{2}|42949017[0-5][0-9])(?:-(?:6553[6-9]|655[4-9][0-9]|65[6-9][0-9]{2}|6[6-9][0-9]{3}|7[0-9]{4}|[1-9][0-9]{5,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|4294900[0-9]{3}|4294901[0-6][0-9]{2}|42949017[0-5][0-9]))?)|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4]|\\*):(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]|\\*))|(?:(?:(?:[1-9]|(?!65535)[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-4]|\\*):)(?:(?:[0-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]|\\*):)(?:[0-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]|\\*)))$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_origin:
      required:
        - "action"
        - "values"
      action:
        regex: "^(?:include|exclude)$"
      values:
        - required:
            - "value"
          value:
            regex: "^(?:igp|egp|incomplete)$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"

  overrides:
    - required:
        - "match"
        - "attributes"
      match:
        - regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
      except:
        - regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
      strict: "^(?:True|False$)"
      attributes:
        # all of the same attributes available under the top-level "prefixes", "bgp", and "ospf" configuration
        # all constraints, EXCEPT prefix constraints, are also available
