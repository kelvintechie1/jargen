basic:
  required:
    - "platforms"
    - "protocols"
    - "addressFamily"
    - "routeSource"
    - "routeExport"
  platforms:
    - regex: "^(?:ios|iosxr|junos|bird|frr|container)$"
  protocols:
    - regex: "^(?:bgp|ospf)$"
  addressFamily:
    regex: "^(?:ipv4|ipv6|ipv4_ipv6)$"
  routeSource:
    regex: "^(?:random|mrt|partial_random_mrt)$"
  routeExport:
    required:
      - "location"
      - "fileName"
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.json$"

mrt:
  collector: "^.*$"

prefixes:
  quantity:
    regex: "^[0-9]+?(?:-[0-9]+)?$"
  prefixLengthRanges:
    - value:
        regex: "^(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))(?:-(?:/(?:[1-9]|[1-2][0-9]|3[0-2])))?$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  routeSeed:
    regex: ".*"
  includePrivateSpace:
    regex: "^(?:True|False)$"

bgp:
  aspath:
    mode:
      regex: "^(?:2byte|4byte|2byte_4byte)$"
    quantity:
      - value:
          regex: "^[0-9]+?(?:-[0-9]+)?$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    includePrivateAS:
      - value:
          regex: "^(?:True|False$)"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  communities:
    mode:
      regex: "^standard|large|standard_large$"
    quantity:
      - value:
          regex: "^[0-9]+?(?:-[0-9]+)?$"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    includeWellKnown:
      - value:
          regex: "^(?:True|False$)"
        probability:
          regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  nexthop:
    - value:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  origin:
    - value:
        regex: "^(?:igp|egp|incomplete)$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"

ospf:
  routeType:
    - value:
        regex: "^(?:intra_area|inter_area|external_type1|external_type2|nssa_type1|nssa_type2)$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"
  metricRanges:
    - value:
        regex: "^(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])(?:-(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]))?$"
      probability:
        regex: "^(?:[1-9]|[1-9][0-9]|100)$"

device:
  configExport:
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.txt$"
  ios:
    localAS:
      regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
    vrf:
      regex: ".*"
    deployment:
      address:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
  junos:
    vrf:
      regex: ".*"
    bgpGroup:
      regex: ".*"
    deployment:
      address:
        regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
  bird:
  frr:

container:
  imageExport:
    location:
      regex: ".*"
    fileName:
      regex: ".*\\.tar$"
  configExport:
    location:
      regex: ".*"
  bgp:
    localAS:
      regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
    rid:
      regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
    neighbors:
      - address:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
        asn:
          regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
  ospf:
    rid:
      regex: "^(?:(?:0\\.0\\.0\\.(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))$"
    areaID:
      regex: "^(?:(?:0\\.0\\.0\\.(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])|(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]))$"
  networking:
    mode:
      regex: "^(?:dynamic|static)$"
    static:
      ipv4:
        address:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
        gateway:
          regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
      ipv6:
        address:
          regex: "^(?:(?:(?:[0-9a-fA-F]{1,4}:){1,7}:)|(?:(?:[0-9a-fA-F]{1,4}:){1,6}:(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,5}:(?:[0-9a-fA-F]{1,4}:)(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,4}:(?:[0-9a-fA-F]{1,4}:){2}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,3}:(?:[0-9a-fA-F]{1,4}:){3}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,2}:(?:[0-9a-fA-F]{1,4}:){4}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:):(?:[0-9a-fA-F]{1,4}:){5}(?:[0-9a-fA-F]{1,4}))|(?:::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}))(?:/(?:[1-9]|[1-9][0-9]|1[0-1][0-9]|12[0-8]))$"
        gateway:
          regex: "^(?:(?:::)|(?:(?:[0-9a-fA-F]{1,4}:){1,7}:)|(?:(?:[0-9a-fA-F]{1,4}:){1,6}:(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,5}:(?:[0-9a-fA-F]{1,4}:)(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,4}:(?:[0-9a-fA-F]{1,4}:){2}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,3}:(?:[0-9a-fA-F]{1,4}:){3}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:){1,2}:(?:[0-9a-fA-F]{1,4}:){4}(?:[0-9a-fA-F]{1,4}))|(?:(?:[0-9a-fA-F]{1,4}:):(?:[0-9a-fA-F]{1,4}:){5}(?:[0-9a-fA-F]{1,4}))|(?:::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}))$"
  attributes:
    - name:
        regex: ".*"
      value:
        regex: ".*"

policy:
  constraints:
    prefix:
      action:
        regex: "^(?:include|exclude)$"
      values:
        - value:
            regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_aspath:
      action:
        regex: "^(?:include|exclude)$"
      values:
        origin:
          - value:
              regex: "^(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))$"
            probability:
              regex: "^(?:[1-9]|[1-9][0-9]|100)$"
        transit:
          - value:
              regex: "^(?:(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))(?: (?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])|(?:(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])\\.(?:[1-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])))*)$"
            probability:
              regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_communities:
      action:
        regex: "^(?:include|exclude)$"
      values:
        - value:
            regex: "^(?:(?:(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5])(?:-(?:[1-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]))?)|(?:(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]|\\*):(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]|\\*))|(?:(?:(?:[0-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]|\\*):){2}(?:[0-9]|[1-9][0-9]{1,8}|[1-3][0-9]{9}|4[0-1][0-9]{8}|42[0-8][0-9]{7}|429[0-3][0-9]{6}|4294[0-8][0-9]{5}|42949[0-5][0-9]{4}|429496[0-6][0-9]{3}|4294967[0-1][0-9]{2}|42949672[0-8][0-9]|429496729[0-5]|\\*)))$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"
    bgp_origin:
      action:
        regex: "^(?:include|exclude)$"
      values:
        - value:
            regex: "^(?:igp|egp|incomplete)$"
          probability:
            regex: "^(?:[1-9]|[1-9][0-9]|100)$"

  overrides:
    - match:
        - regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
      except:
        - regex: "^(?:(?:[1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.)(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){2}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:/(?:[1-9]|[1-2][0-9]|3[0-2]))$"
      strict: "^(?:True|False$)"
      attributes:
        # all of the same attributes available under the top-level "prefixes", "bgp", and "ospf" configuration
        # all constraints, EXCEPT prefix constraints, are also available
